================================================================================
                        VS1024 - 対戦型2048 設計書 v2.0
                              作成日: 2024/12/18
================================================================================

【1. 概要】
────────────────────────────────────────────────────────────────────────────────
VS1024は2048パズルゲームを対戦型にアレンジしたモバイル向けWebゲーム。
プレイヤーはCPUと対戦し、攻撃・妨害・スキルを駆使して相手のHPをゼロにする。
PWA対応でスマートフォンにインストール可能。

【2. 基本ルール】
────────────────────────────────────────────────────────────────────────────────
■ HP
  - 両者5HPでスタート
  - HPがゼロになったら敗北

■ 攻撃タイル（タップで発動、タイル消滅）
  ┌──────────┬──────────┬──────────────────┐
  │ タイル   │ ダメージ │ 追加効果         │
  ├──────────┼──────────┼──────────────────┤
  │ 128      │ 0        │ 妨害タイル×1     │
  │ 512      │ 1        │ 妨害タイル×3     │
  │ 1024     │ 4        │ なし             │
  └──────────┴──────────┴──────────────────┘

■ 自動妨害
  - 256タイル生成時 → 相手に妨害タイル×1

■ 妨害タイル
  - 3秒の予告後、相手盤面のランダム位置に「2」を追加
  - 敵盤面では赤く光って表示

■ 詰み処理
  - 盤面が詰んだ場合 → HP-2 + 盤面の「2」を全消し
  - 詰みでHPがゼロになったら敗北

■ マッチポイント
  - HP1の状態でボード枠が光る演出

【3. スキルシステム】
────────────────────────────────────────────────────────────────────────────────
■ スキル付与
  - 新規タイル生成時、5%の確率でスキル付与
  - スキル付きタイルは右上にアイコン表示
  - 重み付きランダムで全30スキルから選択

■ スキル発動
  - スキル付きタイルを合成すると確定発動
  - 両方にスキルがある場合、両方発動

■ 弾演出
  - プレイヤースキル発動 → シアンの弾
  - CPUスキル発動 → 赤の弾

【4. 全30スキル一覧】
────────────────────────────────────────────────────────────────────────────────

★5 レジェンド（5種）
┌─────────────────┬────┬───────────────────────────────────────────────────┐
│ スキル名        │Cost│ 効果                                              │
├─────────────────┼────┼───────────────────────────────────────────────────┤
│ ラストスタンド  │ 8  │ 2ダメ以上で死ぬとき1回だけ無効化                  │
│ オーバーフロー  │ 7  │ 10秒間、敵の移動で2タイルが2個生成                │
│ リザレクション  │ 7  │ 死亡時1回だけHP1で復活（盤面リセット）            │
│ ミラー          │ 7  │ 敵盤面を自分の盤面にコピー                        │
│ カース          │ 7  │ 次に受けたダメージを敵にも反射                    │
└─────────────────┴────┴───────────────────────────────────────────────────┘

★4 エピック（5種）
┌─────────────────┬────┬───────────────────────────────────────────────────┐
│ スキル名        │Cost│ 効果                                              │
├─────────────────┼────┼───────────────────────────────────────────────────┤
│ ダブル          │ 5  │ 次の攻撃ダメージ2倍                               │
│ ガーディアン    │ 5  │ 次の攻撃を無効化                                  │
│ ヒール          │ 6  │ HP1回復（最大HP上限まで）                         │
│ フリーズ        │ 5  │ 相手の盤面を3秒間停止                             │
│ リフレクト      │ 5  │ 次の妨害タイルを跳ね返す                          │
└─────────────────┴────┴───────────────────────────────────────────────────┘

★3 レア（6種）
┌─────────────────┬────┬───────────────────────────────────────────────────┐
│ スキル名        │Cost│ 効果                                              │
├─────────────────┼────┼───────────────────────────────────────────────────┤
│ アポカリプス    │ 4  │ お互いの盤面をリセット                            │
│ スマッシュ      │ 4  │ ランダムに敵タイル1個破壊                         │
│ タイムボム      │ 4  │ 敵盤面にボム(2~8)設置、5秒で3×3爆発               │
│ ピュリファイ    │ 4  │ 自分の不利効果/相手の有利効果を削除               │
│ ブースト        │ 4  │ 自分のランダムな数字タイルを全て1段階上げる       │
│ スティール      │ 4  │ 相手タイルを1つランダムに奪取                     │
└─────────────────┴────┴───────────────────────────────────────────────────┘

★2 アンコモン（7種）
┌─────────────────┬────┬───────────────────────────────────────────────────┐
│ スキル名        │Cost│ 効果                                              │
├─────────────────┼────┼───────────────────────────────────────────────────┤
│ アーマー        │ 3  │ 次の攻撃ダメージ-1                                │
│ アンプリファイ  │ 3  │ 次の妨害タイル数2倍                               │
│ スワップ        │ 3  │ お互いのランダムな数字タイルを交換                │
│ ヴァニッシュ    │ 3  │ 2~128のランダムな数字を両者から全消し             │
│ アンカー        │ 3  │ 四隅の空きマスに2タイルを配置                     │
│ ディケイ        │ 3  │ お互いの全タイルを1レベル下げる（2は消滅）        │
│ アップグレード  │ 3  │ 自分の2を全て4に変換                              │
└─────────────────┴────┴───────────────────────────────────────────────────┘

★1 コモン（7種）
┌─────────────────┬────┬───────────────────────────────────────────────────┐
│ スキル名        │Cost│ 効果                                              │
├─────────────────┼────┼───────────────────────────────────────────────────┤
│ ダブルエッジ    │ 2  │ お互いに1ダメージ                                 │
│ スクランブル    │ 2  │ お互いに2タイルを3つランダム生成                  │
│ スウィープ      │ 2  │ お互いの2を3つずつ消去                            │
│ ディスラプト    │ 2  │ 相手に妨害タイル1個生成                           │
│ ウィークン      │ 2  │ 相手のランダムな1種類を全て1レベル下げる          │
│ カタクリズム    │ 2  │ お互いの盤面を入れ替え                            │
│ フュージョン    │ 2  │ 自分の盤面で1ペア自動合成                         │
└─────────────────┴────┴───────────────────────────────────────────────────┘

合計: 30スキル

【5. スキル状態フラグ】
────────────────────────────────────────────────────────────────────────────────
■ プレイヤー/敵共通
  - Shield: 次攻撃無効
  - Reflect: 次妨害跳ね返し
  - Double: 次攻撃2倍
  - Resurrection: 死亡時復活
  - Armor: 次ダメージ-1
  - Amplify: 次妨害2倍
  - Laststand: 致死ダメージ無効
  - Curse: ダメージ反射
  - Overflow: 移動時2タイル生成（10秒間）
  - Frozen: 行動停止（3秒間）

【6. CPU AI（レベル1-10）】
────────────────────────────────────────────────────────────────────────────────
┌────┬────────────┬────────────────────────────────────────────────────────┐
│ Lv │ 名称       │ 特徴                                                   │
├────┼────────────┼────────────────────────────────────────────────────────┤
│ 1  │ EASY       │ 完全ランダム移動、ほぼ攻撃しない                       │
│ 2  │ NORMAL     │ 基本優先順位（下→左→右→上）                           │
│ 3  │ HARD       │ コーナー戦略（左→下→右→上）                           │
│ 4  │ EXPERT     │ 評価関数使用                                           │
│ 5  │ MASTER     │ 1手先読み                                              │
│ 6  │ LEGEND     │ 2手先読み                                              │
│ 7  │ NIGHTMARE  │ 2手先読み + 攻撃的                                     │
│ 8  │ INFERNO    │ 3手先読み                                              │
│ 9  │ ABYSS      │ 3手先読み + 高度戦略                                   │
│ 10 │ WORLD END  │ 4手先読み + 超高速 + 容赦なし攻撃                      │
└────┴────────────┴────────────────────────────────────────────────────────┘

■ 評価関数
  - 空きマス数（高レベルほど重視）
  - 最大タイル値
  - コーナー配置ボーナス
  - 単調性（タイルの並び順）
  - 合成可能ペア数
  - スネークパターン（Lv9+）

【7. UI構成】
────────────────────────────────────────────────────────────────────────────────
■ 5タブ構成
  1. ガチャ - タイルガチャ/スキルガチャ
  2. ステージ - 難易度1-10
  3. ホーム - VSボタン
  4. スキル - 所持スキル管理/プリセット
  5. コレクション - タイルスキン管理

■ ヘッダー
  - クリスタル表示
  - SP表示

■ バトル画面
  - 敵HP/プレイヤーHP
  - 敵盤面（小）/プレイヤー盤面（大）
  - バトルログ（枠のみ、1行）
  - 妨害予告

【8. ガチャシステム】
────────────────────────────────────────────────────────────────────────────────
■ 料金
  - 1回: 300（クリスタル or SP）
  - 11連: 3000

■ 排出率
  ┌────────┬────────┐
  │ レア度 │ 確率   │
  ├────────┼────────┤
  │ ★5    │ 5%     │
  │ ★4    │ 10%    │
  │ ★3    │ 20%    │
  │ ★2    │ 25%    │
  │ ★1    │ 30%    │
  └────────┴────────┘

■ タイルガチャ
  - クリスタル使用
  - スキンの「2」のみ排出
  - コレクション画面で合成して4, 8, ... 1024を作成

■ スキルガチャ
  - SP使用
  - スキル画面に追加

【9. タイルスキンシステム】
────────────────────────────────────────────────────────────────────────────────
■ 所持形式
  各スキンごとに各数字(2,4,8,...,1024)の所持数を管理

■ 合成
  同じスキンの同じ数字を2個使って次の数字を1個作成
  例: neon の 2 を2個 → neon の 4 を1個

■ 装備
  数字ごとに異なるスキンを装備可能
  例: 2=neon, 4=pastel, 8=gold, ...

■ スキン一覧（13種）
  - normal (★1): デフォルト
  - neon (★2): 発光エフェクト
  - pastel (★2): 淡い色合い
  - dark (★2): ダークモード
  - gold (★3): 金色グラデーション
  - crystal (★3): 透明感のある輝き
  - fire (★3): 炎エフェクト
  - ice (★3): 氷エフェクト
  - galaxy (★4): 宇宙柄
  - rainbow (★4): 虹色グラデーション
  - cyber (★4): サイバーパンク風
  - hologram (★5): ホログラフィック
  - plasma (★5): プラズマエフェクト

【10. 通貨システム】
────────────────────────────────────────────────────────────────────────────────
■ クリスタル
  - 用途: タイルガチャ
  - 獲得: ステージ初回クリア (300)

■ SP (スキルポイント)
  - 用途: スキルガチャ
  - 獲得: バトルスコア / 300

【11. スキルプリセット】
────────────────────────────────────────────────────────────────────────────────
- 5つのプリセットスロット
- 総コスト = 20（ちょうど）
- 同じスキルは1個まで
- オートセット機能: レアリティ優先で自動装備

【12. ファイル構成】
────────────────────────────────────────────────────────────────────────────────
/VS1024
├── index.html          # メインHTML
├── manifest.json       # PWA設定
├── sw.js              # Service Worker
├── css/
│   ├── style.css      # メインスタイル (~2900行)
│   └── skins.css      # タイルスキン定義
├── js/
│   ├── board.js       # 盤面管理 (~580行)
│   ├── game.js        # ゲームロジック (~1180行)
│   ├── ai.js          # CPU AI (~560行)
│   ├── skills.js      # スキル定義 (~450行)
│   ├── data.js        # データ管理 (~515行)
│   ├── main.js        # UI/イベント管理 (~1300行)
│   └── ui.js          # UI演出
├── sprite/            # スキルアイコン (30枚)
├── tab/               # タブアイコン (5枚)
└── docs/              # ドキュメント

【13. 技術仕様】
────────────────────────────────────────────────────────────────────────────────
■ フロントエンド
  - Vanilla JavaScript (ES6+)
  - CSS3 (Grid, Flexbox, Animations)
  - Web Storage API (localStorage)

■ PWA
  - manifest.json
  - Service Worker (キャッシュ戦略)
  - ホーム画面追加対応

■ レイヤーシステム (z-index)
  - ボード背景: 1-2
  - タイル: 5-6
  - スキルアイコン: 15-16
  - フリーズ: 30
  - バトルログ: 40
  - スキル弾: 100
  - モーダル: 500-1000

■ ライトテーマカラー
  - 背景: #f0f2f5
  - カード: #ffffff
  - アクセント: シアン, ピンク, パープル

【14. 既知の仕様・注意点】
────────────────────────────────────────────────────────────────────────────────
1. スキル付きタイルはoverflow:visibleで表示
2. タイル盤背景は#bbada0（2048公式に近い）
3. バトルログは枠のみ（背景なし）
4. マッチポイントでボード枠が光る
5. 詰み時は「2」だけ消去（全リセットではない）
6. リザレクションは盤面リセットを伴う復活

【15. 今後の拡張予定】
────────────────────────────────────────────────────────────────────────────────
- ランクマッチ (オンライン対戦)
- PvP (リアルタイム対人戦)
- スキル強化システム
- 追加スキン
- 追加ステージ

================================================================================
                              END OF DOCUMENT
================================================================================

